﻿# 3D Battlescape: First-Person Alternative View

> **Status**: Design Document  
> **Last Updated**: 2025-10-28  
> **Related Systems**: Battlescape.md, Units.md, Items.md

## Table of Contents

- [When to Read This](#when-to-read-this)
- [Perspective Differences](#perspective-differences)
- [Input Controls](#input-controls)
- [Vision & Field of View](#vision--field-of-view)
- [HUD & Information Display](#hud--information-display)
- [Unit Selection & Squad Management](#unit-selection--squad-management)
- [Perspective Switching](#perspective-switching)
- [Information Asymmetry](#information-asymmetry)
- [Movement & Controls](#movement--controls)
- [Combat (Identical to 2D)](#combat-identical-to-2d)
- [Environmental Effects](#environmental-effects)
- [What's IDENTICAL to 2D](#whats-identical-to-2d)
- [Design Philosophy](#design-philosophy)
- [Summary](#summary)

---

## When to Read This

## Overview

### Design Concept

**3D Battlescape** provides a first-person perspective inspired by Eye of the Beholder, Dungeon Master, and Wizardry—fully turn-based. It's an alternative visual representation of the identical hex-grid tactical system used in 2D Battlescape.

**Core Principle**: Pure visual difference. All mechanics, calculations, and balance are IDENTICAL to 2D Battlescape. The game state is 100% synchronized; only the camera perspective changes.

### When to Read This
- How movement/UI works in 3D (WSAD controls, unit selection, etc.)
- What a 3D player SEES vs. what 2D player sees
- Differences in information access and tactical approach
- How minimap and HUD function in first-person view

**DO NOT come here for game mechanics:**
- Accuracy, damage, movement costs, AP → See **Battlescape.md** (IDENTICAL in 3D)
- Unit stats, traits, progression → See **Units.md** (IDENTICAL in 3D)
- Equipment, weapons, armor → See **Items.md** (IDENTICAL in 3D)
- Status effects, morale, sanity → See **Battlescape.md** (IDENTICAL in 3D)

**The entire combat system is the same in both perspectives. This file is ONLY about visual/interface differences.**

---

## Perspective Differences

### What 2D Player Sees vs. 3D Player

| Aspect | 2D Battlescape | 3D Battlescape | Impact |
|---|---|---|---|
| **Field of View** | Full map (40×30 hex grid) | 90° cone limited | 3D player sees less; must plan accordingly |
| **Information** | Omniscient (all units visible) | Limited by FOV cone + sight stat | 3D vulnerable from behind; must check minimap |
| **Movement Input** | Click destination | WSAD keyboard | Different control style, identical result |
| **Unit Selection** | Click on map | Tab / click panel | Tab-cycling adds urgency |
| **Squad Awareness** | Visual units on map | HUD panel + minimap | 3D requires more HUD reading |
| **Threat Detection** | See all enemies at once | Only forward arc | 3D must rotate to discover threats |
| **All Combat Calculations** | Formulas apply | **IDENTICAL FORMULAS** | **Zero mechanical difference** |

**Bottom Line**: 3D is immersive first-person view. All game mechanics, balance, and outcomes identical to 2D. Differences are purely perceptual/interface—same battlefield, different camera.

---

## Input Controls

### Movement (WSAD)

| Key | Action | Effect |
|---|---|---|
| **W** / Up Arrow | Move forward | Advance 1 hex in facing direction (1 AP) |
| **S** / Down Arrow | Move backward | Retreat 1 hex (1 AP) |
| **A** / Q | Rotate left | Turn 60° counterclockwise (no AP cost) |
| **D** / E | Rotate right | Turn 60° clockwise (no AP cost) |
| **Shift + W/S/A/D** | Run | 50% movement cost but cannot fire (-3 sight range) |
| **Ctrl + W/S/A/D** | Sneak | 200% movement cost but +3 cover bonus |

**Note**: Rotation (A/D) is free and doesn't consume AP. This lets player look around without wasting movement budget.

### Unit Selection

| Input | Action |
|---|---|
| **Tab** | Cycle to next squad member |
| **Shift + Tab** | Cycle to previous squad member |
| **1-9** | Quick-select squad slot (if configured) |
| **Click Squad Panel** | Select unit from HUD roster |

**Important**: When player selects different unit, camera snaps to that unit's position/facing. Player continues turn with new unit selected.

### Combat & Actions

| Input | Action |
|---|---|
| **Left-click / Spacebar** | Fire primary weapon (accuracy by formula, not aim quality) |
| **Right-click** | Fire secondary / alternate mode |
| **R** | Reload weapon |
| **G** | Throw grenade |
| **C** | Change stance (stand/kneel/prone) or take cover |
| **V** | Toggle between 2D and 3D perspective |

### Interface

| Input | Action |
|---|---|
| **T** | Toggle hex grid overlay (learn 3D-to-hex mapping) |
| **M** | Toggle minimap display |
| **H** | Toggle HUD (hide for immersion) |
| **ESC** | Pause game / open menu |

---

## Vision & Field of View

### 3D Limitations (not in 2D)

**Field of View:**
- 90° total vision cone (45° left/right from center facing)
- 15 hex distance vision range
- Behind unit is invisible
- Both FOV cone AND sight range must be satisfied

**Example:**
- Unit has 12 hex day sight range
- Enemy at 10 hexes directly forward: **VISIBLE** (in cone + range)
- Enemy at 5 hexes to the side (90° left): **VISIBLE** (in cone + range)
- Enemy at 8 hexes directly behind: **INVISIBLE** (outside cone)
- Enemy at 6 hexes slightly behind left (120°): **INVISIBLE** (outside 90° cone)

**Result**: 3D player must physically look/rotate to see threats from other angles. 2D player sees threats instantly.

### Sight Range (Identical to 2D)

| Condition | Range |
|---|---|
| **Day** | 8-12 hexes (unit dependent) |
| **Night** | 3-6 hexes (unit dependent) |
| **Flashlight equipped** | +2 hexes |
| **Night vision goggles** | +5 hexes |

**Application**: Sight stat is identical to 2D; only difference is FOV cone limits visibility in 3D.

### Line-of-Sight Calculation

**Raycast Method:**
- Raycast from attacker eye position → target center
- Hit terrain = cover effectiveness applied
- Elevation affects accuracy:
  - Upshot: -accuracy penalty (shooting upward)
  - Downshot: +accuracy bonus (shooting downward)

### Visual Hex Verification

- Toggle feature: Press **T** for wireframe hex grid overlay
- Purpose: Verify targeting, learn 3D-to-state mapping
- Useful for learning 3D system
- Toggle off when experienced player

---

## HUD & Information Display

### Squad Panel (Left or Bottom)

**Display:**
- Compact list of all squad members
- Each shows: Name, HP bar (color-coded), AP remaining, morale icon
- Currently selected unit highlighted
- Click to select different unit
- Example: "SGT Rodriguez [8/12 HP] 4 AP ★★"

**Status Icons (for selected unit):**
- Red skull: Dead/unconscious
- Orange flame: On fire
- Purple star: Stunned
- Blue shield: Taking cover
- Yellow bolt: Suppressed
- Eye icon: Being watched (reaction fire active)

**Information per Unit:**
- Name & Rank: "CPL Jackson, Rank 2 Specialist"
- HP: "10/12" (visual bar + numeric)
- AP: "4" (or reduced if wounded -1 AP penalty)
- Morale: "8" (numeric 0-12 scale)
- Sanity: "7" (numeric 0-12)
- Status Effects: Icons for stun, suppression, fire, fear, etc.
- Distance: "6 hexes SW" (compass direction to unit)
- Weapon: "Rifle [12/120]" (current ammo)

### Distance Indicator (When Targeting)

- "12 hexes NW" shows range and direction
- Updates as player aims
- Red if out of weapon range

**Weapon Status (Selected Unit's Weapon):**
- "Rifle [15/120 ammo]" shows loaded ammo / reserve
- Red indicator if low ammo (< 25%)
- "Reloading..." status appears during reload animation

### Minimap (Optional, Toggle with M)

**Display:**
- Small 2D top-down grid (upper right corner)
- Shows explored hexes and fog-of-war
- Friendly units: Blue circles
- Enemy units: Red circles (if visible to any squad member)
- Current player unit: Bright marker showing facing direction (arrow pointing up)
- Terrain: Green (grass), brown (rough), gray (stone), etc.

**Uses:**
- Check squad positions without clicking through roster
- See enemies beyond current FOV
- Monitor enemy movements
- Plan rotations and repositioning

**Info**: Minimap shows **what the squad collectively sees** (shared team vision). Enemy units marked only if visible to any teammate.

### Targeting Reticle

**Visual Feedback:**
- Center-screen crosshair shows aimed direction
- Green reticle: Line-of-sight clear to target, good accuracy
- Yellow reticle: Partial obstruction (cover/smoke), reduced accuracy
- Red reticle: Line-of-fire blocked, cannot fire
- Distance numeric: "8 hexes" shows exact range

**Important Note**: Reticle color is cosmetic feedback. Actual accuracy determined by Battlescape.md formula (range, weapon mode, cover, morale penalties, etc.). Aiming visually doesn't improve accuracy—formula decides hit/miss.

---

## Unit Selection & Squad Management

### Selecting Units

**Methods:**
1. **Tab key**: Cycles through squad roster in order
2. **1-9 keys**: Jump to specific slot if configured
3. **Click Squad Panel**: Select unit from list on-screen
4. **Voice command** (future): May support spoken unit names

**What Happens:**
- Camera snaps to selected unit's position
- Unit's facing direction becomes camera direction (or most recent facing)
- HUD updates to show selected unit's stats/equipment
- Next movement command applies to selected unit

### Controlling Multiple Units

**Turn Structure:**
- All units in player squad act during **Player Team Turn**
- Player chooses order of unit actions
- Can select Unit A, give it commands, then Tab to Unit B, give it commands
- All actions accumulate until turn ends
- Press "End Turn" to confirm and move to next turn

**Tactical Workflow Example:**
1. Start with unit 1 (Tab)
2. Move forward (W), fire (Spacebar)
3. Tab to unit 2
4. Move left (A + W diagonal), take cover (C)
5. Tab to unit 3
6. Move to flank position
7. End Turn → all units confirmed, next turn starts

---

## Perspective Switching

### Mid-Mission Toggle

**How:**
- Press **V** anytime during your turn
- Instantly switches between 2D and 3D views
- No AP cost, no penalty, no delay

**What Happens:**
- Game state 100% preserved
- Current unit selection maintained
- All AP, morale, HP, stun unchanged
- Camera simply changes from first-person to overhead

**Tactical Use:**
- Get confused in 3D? Switch to 2D for clarity
- Planned full turn in 2D? Switch to 3D to execute with immersion
- Alternate as needed for different combat situations

**Example:**
1. Start in 3D, see ambush incoming
2. **V** → Switch to 2D, review full squad + enemy positions
3. Position units for counter-ambush using 2D clarity
4. **V** → Back to 3D for immersive attack execution
5. Attack plays out dramatically in first-person view

---

## Information Asymmetry

### 3D vs. 2D Awareness

**Limited Information in 3D:**
- Cannot see behind unit (requires rotation)
- Cannot see full squad at once (need minimap or panel)
- Cannot see entire battlefield simultaneously
- Surprise attacks from unseen angles are possible

**Compensation Mechanisms:**
- **Minimap**: Shows full squad and visible enemies
- **Squad Panel**: Display all teammate status without visual contact
- **Numeric indicators**: Distance/direction reduces spatial guessing
- **Perspective toggle**: Switch to 2D for omniscient planning
- **Teammate AI**: Allies see/hear threats you might miss

**Strategic Implication:**
- 3D gameplay emphasizes tactical immersion, not omniscience
- Player must communicate with squad (AI knows things player doesn't)
- Information gathering becomes tactical—"scout ahead" is real action
- Surprises remain possible (feature, not bug)

### When Players Converge

**Identical Outcome Despite Information Asymmetry:**
- Same accuracy calculations regardless of view
- Same movement costs regardless of view
- Same damage application regardless of view
- Same AP/stun/morale system
- **Result**: 3D and 2D players finishing identical missions get same rewards, casualties, etc.

---

## Movement & Controls

### Movement Mechanics

**Turn-Based System (Identical to 2D):**
- **Action Points (AP)**: Fixed 4 per turn for all units
- **Status Effects**: Morale penalties reduce AP available (identical to 2D)
- **No Real-Time**: All movement and actions occur during turn phases

### Hex-Based Movement

| Direction | Input | Effect |
|---|---|---|
| Forward | W or Up Arrow | Advance 1 hex in facing direction |
| Backward | S or Down Arrow | Retreat 1 hex |
| Left | A or Q | Rotate 60° counterclockwise |
| Right | D or E | Rotate 60° clockwise |
| Diagonal | W + A/D | Move forward + rotate simultaneously |

### Movement Cost (Identical to 2D)

| Terrain Type | Cost |
|---|---|
| **Clear ground** | 1 MP |
| **Road/path** | 1 MP |
| **Difficult (sand, mud)** | 2 MP |
| **Very difficult (marsh, rubble)** | 3 MP |
| **Extreme (dense forest, steep)** | 4–5 MP |
| **Wall/impassable** | 99 (blocked) |

**Movement Calculation:**
- Base: MP = AP × Speed stat
- Speed: Class-dependent (typically 1-2)
- Example: 4 AP available × Speed 1 = 4 hexes per turn

**Movement Options (Identical to 2D):**
- **Normal**: 1 AP per hex
- **Running**: 50% movement cost but cannot fire (-3 sight range)
- **Sneaking**: 200% movement cost but +3 cover bonus
- **Elevation penalty**: +8 MP for climbing, no penalty descending

### Terrain Navigation

**Terrain Rendering:**
- Terrain renders as 3D floor with height variation
- Obstacles render as 3D walls of various heights
- Destructible terrain appears as structure/rubble
- Elevation visually represented as height change

### Visual Depth Cues

**Distance Perception:**
- Far hexes (10+ hexes away): Rendered with blue haze/fog
- Creates atmospheric depth and matches sight range visually
- Enemies at max sight range appear dim/faded
- Nearby enemies clear and detailed

**Size Scaling:**
- Distant units appear small
- Nearby units appear large
- Provides intuitive distance feedback

---

## Combat (Identical to 2D)

### Fire Combat

**Ranged Attack Process:**
1. Target Selection: Choose target within line-of-sight and range
2. Accuracy Calculation: Apply all modifiers (see Battlescape.md)
3. Projectile Firing: Fire weapon
4. Damage Application: Apply damage if hit, handle armor reduction

### Weapon Modes (Identical to 2D)

| Mode | AP Cost | Accuracy | Effect | Use Case |
|---|---|---|---|---|
| **Snap** | 1 | −5% | Quick, inaccurate shot | Suppressive fire |
| **Auto** | 2 | −10% | Burst of fire | Area suppression |
| **Burst** | 2 | ±0% | Controlled burst | Balanced damage |
| **Aim** | 2 | +15% | Careful, precise shot | Critical targets |
| **Melee** | 1 | ±0% | Hand-to-hand attack | Close combat |
| **Thrown** | 2 | ±0% | Launch object | Grenades, items |

### Melee Combat (Identical to 2D)

- **AP Cost**: 1 AP per attack
- **Range**: 1 hex (adjacent unit only)
- **Damage**: Weapon-dependent; typically 15-20
- **Defense Roll**: Defender can attempt dodge/parry (passive, no AP cost)
- **Defense uses**: Reaction or Melee stat
- **Success**: Reduces damage or negates hit

### Weapon Range (Identical to 2D)

Assuming weapon with **max range = 12 hexes:**

**Close Range (0–75% = 0–9 hexes):**
- Accuracy: 100% at 0%, declining linearly to 50% at 75%
- Formula: `accuracy = 100 − (50 × distance / 9)`

**Medium Range (75–100% = 9–12 hexes):**
- Accuracy: 50% at 75%, declining linearly to 0% at 100%
- Formula: `accuracy = 50 − (50 × (distance − 9) / 3)`

**Long Range (100–125% = 12–15 hexes):**
- Accuracy: 0% at 100%, declining to −100% at 125%
- Only possible with exceptional circumstances (sniper scope, etc.)

**Minimum Range (Some weapons):**
- Sniper rifles: −50% accuracy within 3 hexes
- Shotguns: No minimum range penalty

---

## Environmental Effects

### Day vs. Night

**Day Conditions (Identical to 2D):**
- Full sight range (8-12 hexes typically)
- No vision penalty from time of day
- Colors rendered naturally
- Standard lighting conditions

**Night Conditions (Identical to 2D):**
- Reduced sight range (3-6 hexes typically)
- Units have separate "night sight" stat
- Blue tinting applied for atmosphere
- Sanity penalty (−1 after mission)
- Equipment modifiers: Flashlight (+2), night vision goggles (+5)

### Weather Impact on Vision (Identical to 2D)

| Weather | Sight Cost | Vision Impact |
|---|---|---|
| **Normal** | Baseline | Full visibility |
| **Rain** | +1 per tile | Reduced clarity |
| **Snow** | +2 per tile | Heavy reduction |
| **Blizzard** | +3 per tile | Extreme reduction |
| **Sandstorm** | +2 per tile | Dust clouds |
| **Heavy Fog** | +3 per tile | Near-total loss |

**Application**: Weather modifies sight costs globally, reducing visibility for all units equally.

---

## What's IDENTICAL to 2D

**The entire combat system works identically in 3D:**

- **Accuracy Formula**: Base + weapon + mode + range + cover + LOS = final accuracy (see Battlescape.md)
- **Damage Calculation**: Weapon damage × hit × armor resistance (see Battlescape.md)
- **Movement Costs**: Terrain costs identical (1 MP clear, 2 MP swamp, 3 MP marsh, etc.)
- **Action Points**: Fixed 4 per turn, morale penalties reduce (see Battlescape.md)
- **Sight Cost**: Clear 1, smoke 2-4, obstacles 1-6, cumulative (see Battlescape.md)
- **AP Penalties**: 50-26% HP = -1 AP, 25-1% HP = -2 AP (see Battlescape.md)
- **Morale Range**: 0-12, based on BRAVERY stat, panic ≤ 2 (see Battlescape.md)
- **Sanity Range**: 0-12, separate from morale, degradation from horror (see Battlescape.md)
- **Stun System**: Accumulates, decays -1/turn, >= max HP = unconscious (see Battlescape.md)
- **Weapon Modes**: Snap/aim/burst/auto all identical (see Items.md)
- **Projectile Behavior**: Direct line + miss deviation + collision identical (see Battlescape.md)
- **Status Effects**: Fire, smoke, suppression all identical (see Battlescape.md)
- **Unit Stats**: HP, AP, accuracy, strength, melee, bravery ranges identical (see Units.md)
- **Traits**: Character traits apply identically (see Units.md)
- **Transformations**: Unit modifications work identically (see Units.md)

### Shared Game State

**Identical Systems:**
- Hex grid (fundamental)
- Unit positions stored in axial coordinates
- Distance calculations identical
- Line-of-sight calculations identical

**Identical Mechanics:**
- Turn order: Player → Ally → Enemy → Neutral
- Action Points and Energy Points
- All timing mechanics (stun recovery, fire spread)
- Morale progression

**Identical Combat:**
- Weapon accuracy calculation
- Damage application
- Critical hits and armor resistance
- Status effect progression

**Identical Objectives:**
- Mission objectives identical
- Victory/defeat conditions trigger identically
- Difficulty scaling affects both equally

### Campaign Progression

**Identical Progression:**
- Units/missions/equipment unaffected by perspective
- Experience gains identical
- Rewards identical
- Story progression identical

**No Perspective Lock:**
- Complete campaigns in any perspective mix
- Progress saved regardless of perspective
- Campaign state identical

---

## Design Philosophy

### Mechanical Parity Guarantee

**Core Design Principle**: All 3D extensions maintain mechanical parity with 2D system
- No gameplay split between perspectives
- 2D players never disadvantaged
- 3D players never advantaged
- Single balance and testing pass required
- Identical outcomes regardless of perspective chosen

### Performance Targets

**Frame Rate Goals:**
- 60 FPS target (mid-range hardware: GTX 1070)
- 30 FPS minimum (low-end hardware)
- Adjustable LOD slider for player control

**Optimization Techniques:**
- Frustum culling (only visible hexes)
- LOD: Distant low-poly, near detailed
- Particle limits (max budget)
- Top-down faster than first-person

---

## Summary

| Aspect | 2D | 3D | Difference |
|---|---|---|---|
| **Information Access** | Complete map visible | Limited FOV + sight range | 3D requires exploration |
| **Control Method** | Point-and-click | WSAD keyboard | Input method only |
| **Unit Selection** | Click unit on map | Tab or panel | UI method only |
| **Perspective Toggle** | N/A | Press V anytime | Unique 3D feature |
| **All Mechanics** | Standard | **IDENTICAL** | **No difference** |
| **Balance** | Single pass | **SAME PASS** | **No split** |
| **Outcome** | Campaign progress | **IDENTICAL** | **Same results** |

**Conclusion**: 3D is immersive first-person view layered on top of identical game mechanics. The gameplay experience differs only in information access and perspective—the actual combat system, calculations, and progression are 100% identical.
---
## Integration with Other Systems
This 3D Battlescape view system integrates with:
### Battlescape System
- Uses same hex grid, AP costs, combat mechanics
- Provides alternative visualization of tactical layer
- All calculations identical to 2D view
### Units System
- Unit stats (sight, speed, accuracy) apply identically
- Unit actions and abilities work the same
- First-person perspective changes presentation, not mechanics
### Items System
- Equipment visibility and usage unchanged
- Weapon targeting uses same accuracy calculations
- Inventory access identical to 2D
### GUI System
- HUD elements overlay 3D view
- Minimap provides tactical overview
- Can switch to 2D view seamlessly
**For complete system integration details, see [Integration.md](Integration.md)**
