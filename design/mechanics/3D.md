# 3D Battlescape: First-Person Camera System

> **Status**: Design Document
> **Last Updated**: 2025-11-20
> **Related Systems**: Battlescape.md, Units.md, Items.md, DamageTypes.md
> **⚠️ NOTE**: This file covers **camera perspective and interface only**. All game mechanics (accuracy, damage, AP, morale) are 100% identical to 2D Battlescape. See **Battlescape.md** for all combat mechanics.

## Table of Contents

- [Core Design Principle](#core-design-principle)
- [Overview](#overview)
- [Input Controls](#input-controls)
- [Camera & Visibility](#camera--visibility)
- [HUD & Information Display](#hud--information-display)
- [Perspective Toggle](#perspective-toggle)
- [Performance Considerations](#performance-considerations)

## Overview

**3D Battlescape** provides a first-person alternative perspective to the 2D hex grid tactical system. Inspired by Eye of the Beholder, Dungeon Master, and Wizardry—fully turn-based.

**Core Principle**: 3D is purely a **visual/interface layer**. All game mechanics are 100% identical to 2D Battlescape. The hex grid, combat resolution, AP system, accuracy calculations, and damage application are unchanged.

### When to Read This
- How to control 3D first-person movement (WSAD keys)
- Understanding camera field-of-view limitations vs 2D omniscience
- HUD layout and information display in first-person
- How to toggle between 2D and 3D perspectives

### What NOT to Look Here For
- **Combat mechanics**: See **Battlescape.md** (identical in 3D)
- **Accuracy calculations**: See **Battlescape.md** (identical in 3D)
- **Damage and armor**: See **DamageTypes.md** (identical in 3D)
- **Unit stats**: See **Units.md** (identical in 3D)
- **Weapon properties**: See **Items.md** (identical in 3D)

---

## Core Design Principle

**All game mechanics are IDENTICAL between 2D and 3D.**

| System | Difference |
|--------|-----------|
| Accuracy formula | None - IDENTICAL |
| Damage calculation | None - IDENTICAL |
| Movement costs | None - IDENTICAL |
| AP system | None - IDENTICAL |
| Morale/Sanity | None - IDENTICAL |
| Turn order | None - IDENTICAL |
| Campaign progress | None - IDENTICAL |

**The only differences are:**
- **Camera perspective**: First-person vs overhead
- **Information access**: Limited FOV vs omniscient map view
- **Control method**: Keyboard (WSAD) vs mouse clicks
- **UI presentation**: HUD overlay vs tactical display

---

## Input Controls

### Movement (WSAD)

| Input | Action | AP Cost | Effect |
|---|---|---|---|
| **W** | Move forward | 1 | Advance 1 hex in facing direction |
| **S** | Move backward | 1 | Retreat 1 hex |
| **A** | Rotate left | 0 | Turn 60° counterclockwise (free) |
| **D** | Rotate right | 0 | Turn 60° clockwise (free) |
| **Shift + W/S** | Run | 0.5 | 50% movement cost, cannot fire |
| **Ctrl + W/S** | Sneak | 2.0 | 200% movement cost, +3 cover bonus |

**Note**: Rotation (A/D) costs no AP, allowing players to look around without wasting movement budget.

### Unit Selection & Actions

| Input | Action |
|---|---|
| **Tab** | Cycle to next squad member |
| **Shift + Tab** | Cycle to previous squad member |
| **1-9** | Quick-select squad slot |
| **Spacebar / LMB** | Fire primary weapon |
| **RMB** | Fire secondary weapon mode |
| **R** | Reload |
| **G** | Throw grenade |
| **C** | Change stance / take cover |

### Camera & Interface

| Input | Action |
|---|---|
| **V** | Toggle between 2D and 3D perspective |
| **T** | Show hex grid overlay (learning aid) |
| **M** | Toggle minimap |
| **H** | Toggle HUD visibility |
| **ESC** | Pause / menu |

---

## Camera System

### First-Person Camera

**Camera Position**: Attached to selected unit's head position

**Facing Direction**: Controlled by unit's current hex facing (6 facing directions in hex grid)

**Rotation Increments**: 60° per input (A/D keys) to align with hex grid

### Perspective Switching

**How to Toggle:**
- Press **V** anytime during your turn
- Instant switch between 2D overhead and 3D first-person
- **No AP cost, no penalty, no delay**
- Game state preserved (all AP, morale, HP unchanged)
- Unit selection maintained

**Strategic Uses:**
- Confused in 3D? Switch to 2D to see full battlefield
- Planned attack in 2D? Switch to 3D for immersive execution
- Alternate perspectives to overcome information asymmetry

---

## Field of View & Vision

### 3D Vision Limitations

**Field of View (FOV):**
- 90° total vision cone (45° left/right from center)
- Only sees what's in front of unit
- Behind unit is 100% invisible (requires rotation to see)
- Combined with sight range: Must satisfy both FOV AND range

**Sight Range** (identical to 2D):
- Day: 8-12 hexes (unit dependent)
- Night: 3-6 hexes (unit dependent)
- Flashlight: +2 hexes
- Night vision: +5 hexes

**Example FOV Calculation:**
- Unit with 12-hex day sight range in 3D
- Enemy 10 hexes directly ahead: **VISIBLE** (in cone + range)
- Enemy 5 hexes to the left: **VISIBLE** (in 90° cone + range)
- Enemy 8 hexes behind: **INVISIBLE** (outside 90° cone)
- Result: Must physically rotate to see threats from other directions

### Minimap

**Display** (toggle with **M**):
- Small 2D top-down grid (upper right)
- Shows explored hexes and fog-of-war
- Friendly units: Blue circles
- Enemy units: Red circles (if visible to squad)
- Current unit: Bright marker with facing arrow
- Terrain: Green (grass), brown (rough), gray (stone)

**Purpose:**
- See full squad positions without clicking
- Detect enemies beyond current FOV
- Monitor enemy movements
- Plan rotations and repositioning

---

## HUD & Information Display

### Squad Panel

**Left-side roster showing all squad members:**

```
┌─────────────────┐
│ SGT Rodriguez   │ ← Currently selected
│ 8/12 HP | 4 AP  │
│ ★★★ Morale     │
├─────────────────┤
│ CPL Jackson     │
│ 12/12 HP | 3 AP │
│ ★★★★ Morale    │
├─────────────────┤
│ PVT Chen        │
│ 5/10 HP | 2 AP  │
│ ★★ Morale      │
└─────────────────┘
```

**Per-Unit Information:**
- Name & rank
- HP bar + numeric (current/max)
- AP remaining
- Morale indicator (star rating)
- Status icons (fire, stun, suppressed, etc.)

### Targeting Reticle

**Center-screen crosshair:**
- Green: Clear line-of-sight, good accuracy
- Yellow: Partial obstruction, reduced accuracy
- Red: Line-of-fire blocked, cannot fire

**Note**: Reticle is cosmetic feedback. Actual accuracy determined by **Battlescape.md** formula.

### Weapon Status

**For selected unit's current weapon:**
- Weapon name: "Assault Rifle"
- Loaded ammo: "17/120"
- Red indicator if low ammo (< 25%)

---

## Unit Selection

### Selecting Units

**Methods:**
1. **Tab key**: Cycle through squad roster
2. **1-9 keys**: Jump to specific squad slot
3. **Click Squad Panel**: Select unit from list
4. **Shift+Tab**: Cycle backward

### What Happens When Selecting

- Camera snaps to new unit's position
- Unit's facing direction becomes camera direction
- HUD updates to show selected unit's stats/ammo
- Next action applies to selected unit

### Controlling Multiple Units in One Turn

**Turn Structure:**
1. Select Unit A (Tab)
2. Move forward (W), fire weapon (Spacebar)
3. Select Unit B (Tab)
4. Move left (A+W), take cover (C)
5. Select Unit C (Tab)
6. Position for flank
7. **End Turn** → All actions execute in sequence

---

## Implementation Notes

### Mechanical Guarantee

**100% Identical Systems Between 2D and 3D:**
- Same hex grid, same coordinates
- Same AP costs, same terrain movement
- Same accuracy calculations (**Battlescape.md**)
- Same damage application (**DamageTypes.md**)
- Same unit stats (**Units.md**)
- Same weapon properties (**Items.md**)

### Performance

**Frame Rate Targets:**
- 60 FPS: Mid-range hardware (GTX 1070)
- 30 FPS: Low-end hardware
- Adjustable LOD for player control

### Campaign Parity

- Identical unit progression regardless of perspective
- Experience gains identical
- Rewards and casualties identical
- Campaign state synchronized

**No perspective lock**: Complete campaigns using any mix of 2D and 3D perspectives.

---

## Summary

| Aspect | Difference |
|--------|-----------|
| **Visual Perspective** | 3D first-person vs 2D overhead |
| **Information Access** | Limited FOV vs omniscient map |
| **Control Method** | Keyboard (WSAD) vs mouse clicks |
| **All Mechanics** | **100% IDENTICAL** |
| **Results** | Identical outcomes regardless of perspective |

**Conclusion**: 3D Battlescape is an immersive first-person presentation layer on top of the identical 2D tactical system. Choose your preferred perspective—the gameplay experience and outcomes are mathematically identical.
