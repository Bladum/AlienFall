# Enemy Unit Definition Example
# This file demonstrates a complete enemy unit with AI behavior, stats, and loot tables

[[enemy_unit]]
id = "sectoid_commander"
name = "Sectoid Commander"
description = "Elite psionic alien commander with advanced mental abilities and tactical intelligence."

# Unit classification
category = "alien"           # alien, robot, hybrid
species = "sectoid"          # Species group for research unlocks
rank = "commander"           # grunt, veteran, elite, commander, boss
tier = 3                     # Power tier (1-4)

# Base combat statistics
[enemy_unit.stats]
health = 120                 # Hit points
armor = 20                   # Damage reduction
action_points = 12           # Actions per turn
mobility = 6                 # Movement per AP
accuracy = 80                # Base hit chance %
defense = 25                 # Dodge/evasion %
will = 95                    # Resistance to panic/psionics (very high)
sight_range = 15             # Tiles of vision
detection_range = 12         # Tiles to detect hidden units

# Psionic abilities (special for this unit)
[enemy_unit.psionics]
psionic_power = 90           # Strength of psionic attacks
psionic_defense = 85         # Resistance to psi attacks
psionic_abilities = [
    "mind_control",
    "psionic_blast",
    "panic_wave",
    "mind_merge"            # Links with ally to boost stats
]

# Equipment loadout
[enemy_unit.equipment]
primary_weapon = "plasma_rifle"
secondary_weapon = "none"
armor = "sectoid_commander_armor"
items = ["alien_grenade", "mind_shield"]

# Special abilities
[[enemy_unit.abilities]]
id = "mind_control"
name = "Mind Control"
description = "Take control of an enemy soldier"
type = "active_psionic"
ap_cost = 6
range = 10
cooldown = 3                 # Turns between uses
success_chance_base = 0.7    # 70% base chance
will_contest = true          # Target's will reduces success
duration = 3                 # Lasts 3 turns if successful

[[enemy_unit.abilities]]
id = "psionic_blast"
name = "Psionic Blast"
description = "Devastating mental attack causing damage and panic"
type = "active_psionic"
ap_cost = 4
range = 12
cooldown = 0                 # Can use every turn
damage = 30
will_damage = 20             # Also damages target's will
aoe_radius = 0               # Single target

[[enemy_unit.abilities]]
id = "panic_wave"
name = "Panic Wave"
description = "Area effect causing panic in multiple targets"
type = "active_psionic"
ap_cost = 5
range = 10
cooldown = 4
aoe_radius = 3               # 3-tile radius
panic_chance = 0.6           # 60% chance per target
will_contest = true

[[enemy_unit.abilities]]
id = "mind_merge"
name = "Mind Merge"
description = "Link with an ally to boost their combat effectiveness"
type = "active_psionic"
ap_cost = 2
range = 8
cooldown = 0
target = "ally"              # Targets friendly units
duration = "permanent"       # Lasts until commander dies

# Effect bonuses applied to target
[enemy_unit.abilities.effect]
health = 20                  # +20 HP to target
accuracy = 15                # +15% accuracy
will = 20                    # +20 will

[[enemy_unit.abilities]]
id = "tactical_command"
name = "Tactical Command"
description = "Passive ability improving nearby ally accuracy"
type = "passive_aura"
range = 6
effect = { accuracy = 10 }   # +10% accuracy to allies in range

# AI behavior profile
[enemy_unit.ai_behavior]
# Behavior weights (0.0 to 1.0)
aggression = 0.5             # Moderate aggression (stays back)
flanking_preference = 0.3    # Low flanking (uses psionics instead)
cover_preference = 0.8       # High cover preference (valuable unit)
retreat_threshold = 0.3      # Retreats at 30% HP
ability_preference = 0.9     # Strongly prefers using abilities

# Target priority
target_priority = [
    { target_type = "low_will", priority = 0.95 },      # Prioritize weak-willed
    { target_type = "officer", priority = 0.90 },        # Officers are valuable
    { target_type = "psionic", priority = 0.85 },        # Enemy psionics
    { target_type = "sniper", priority = 0.80 },
    { target_type = "support", priority = 0.75 },
    { target_type = "any", priority = 0.50 }
]

# Ability usage strategy
ability_priority = [
    { ability = "mind_control", priority = 0.95, condition = "target_low_will" },
    { ability = "mind_merge", priority = 0.90, condition = "ally_nearby" },
    { ability = "panic_wave", priority = 0.85, condition = "multiple_targets" },
    { ability = "psionic_blast", priority = 0.70, condition = "single_target" }
]

# Positioning strategy
positioning_strategy = "backline"  # stays_back, frontline, flanker, backline
preferred_range = 10               # Prefers to be 10 tiles from enemies
uses_high_ground = true            # Seeks elevated positions

# Spawn conditions
[enemy_unit.spawn]
min_mission_tier = 3         # Only spawns in tier 3+ missions
max_count_per_mission = 2    # Maximum 2 commanders per mission
spawn_weight = 5             # Relative spawn probability (lower = rarer)
min_game_month = 4           # First appears in month 4
requires_pod_leader = true   # Always leads a pod of units

# Pod composition (what spawns with this unit)
[enemy_unit.spawn.pod]
min_pod_size = 3
max_pod_size = 5
preferred_allies = [
    { unit = "sectoid", count = 2 },
    { unit = "sectoid_veteran", count = 1 }
]

# Loot and salvage
[enemy_unit.loot]
corpse_item = "sectoid_commander_corpse"
corpse_drop_chance = 0.9     # 90% chance to leave intact corpse

# Guaranteed drops
guaranteed_drops = [
    "alien_alloys",
    "elerium"
]

# Possible drops (with chances)
possible_drops = [
    { item = "plasma_rifle", chance = 0.7 },
    { item = "psi_amp", chance = 0.5 },
    { item = "mind_shield", chance = 0.4 },
    { item = "alien_commander_armor", chance = 0.3 },
    { item = "alien_data_core", chance = 0.8 }
]

# Research unlocks (analyzing corpse)
research_unlocks = [
    "sectoid_commander_autopsy",
    "advanced_psionics",
    "alien_command_structure"
]

# Score value
score_kill = 50              # Points for killing
score_capture = 100          # Points for capturing alive (2× kill)

# Visual presentation
[enemy_unit.visuals]
sprite = "assets/enemies/sectoid_commander.png"  # 20×20 sprite (10×10 scaled ×2)
icon = "assets/icons/sectoid_commander.png"
animation_set = "sectoid_commander"
color_tint = { r = 150, g = 100, b = 200 }  # Purple tint for commander
size_class = "small"         # small, medium, large
height_offset = 0            # Grid units above ground (0 = grounded)

# Audio
[enemy_unit.audio]
voice_set = "sectoid_psionic"
death_sound = "sfx/sectoid_death.ogg"
movement_sound = "sfx/alien_movement.ogg"
ability_sound = "sfx/psionic_attack.ogg"

# Status effect resistances
[enemy_unit.resistances]
fire = 0.3                   # 30% fire damage reduction
poison = 0.5                 # 50% poison damage reduction
stun = 0.4                   # 40% stun resistance
mind_control = 0.9           # 90% mind control resistance
panic = 0.8                  # 80% panic resistance

# Environmental preferences
[enemy_unit.environment]
preferred_terrain = ["indoor", "urban"]
avoided_terrain = ["water", "lava"]
night_vision = true          # No accuracy penalty in darkness
thermal_vision = false       # Cannot see through smoke

# Special mechanics
[enemy_unit.special]
# Death triggers
death_effect = "psionic_feedback"  # Nearby units take will damage
death_effect_radius = 3
death_effect_damage = 10

# Capture difficulty
capture_difficulty = "very_hard"   # Requires special equipment
capture_value = "high"             # High research value

# Boss mechanics (if designated as mission boss)
[enemy_unit.special.boss_mechanics]
health_multiplier = 1.5            # 50% more HP
summon_reinforcements = true       # Can call for backup
enrage_at_low_hp = true            # Stronger when low HP
immunity_phases = false            # No immunity mechanics

# Campaign integration
[enemy_unit.campaign]
# Strategic layer effects
presence_increases_panic = 15      # Province panic +15 if encountered
first_encounter_story_event = "first_commander_encounter"
research_urgency = "high"          # AI prioritizes researching this

# Balance metadata
[enemy_unit.balance]
power_level = 85             # 0-100 relative power
threat_assessment = "extreme"  # low, medium, high, extreme
expected_player_losses = 1.5   # Average casualties when encountered
expected_unlock_month = 4      # When player typically first sees this

# Modding support
[enemy_unit.modding]
mod_id = "base_game"
author = "AlienFall Team"
version = "1.0.0"
override_priority = 100
tags = ["sectoid", "psionic", "commander", "elite", "boss", "late_game"]

# Balance notes for modders
[enemy_unit.modding.balance_notes]
note = """
The Sectoid Commander is designed as a high-threat psionics specialist that
appears in mid-to-late game missions. Key balance considerations:

Combat Balance:
- High will (95) makes them resistant to player psionics
- Moderate HP (120) + armor (20) = durable but killable
- Psionics are primary threat, not direct combat
- Mind Control can turn player's best soldiers against them

AI Behavior:
- Stays in backline using psionics from range
- Prioritizes low-will targets (support classes)
- Uses Mind Merge on allies before attacking
- Retreats when damaged (preserves high-value unit)

Counterplay:
- High-will soldiers resist mind control better
- Flanking and focus fire recommended
- Mind Shields negate psionic abilities
- Snipers can eliminate from safe distance

If modding:
- Reducing psionic_power makes less threatening
- Increasing cooldowns limits ability spam
- Adjusting spawn_weight controls appearance rate
- Consider mission tier when placing commanders
"""

# Deterministic RNG scopes
[enemy_unit.rng_scopes]
spawn = "enemy:sectoid_commander:spawn"
loot = "enemy:sectoid_commander:loot"
abilities = "enemy:sectoid_commander:abilities"
ai_decisions = "enemy:sectoid_commander:ai"
