# Weapon Definition Example
# This file demonstrates a complete weapon with all properties and balance considerations

[[weapon]]
id = "plasma_rifle"
name = "Plasma Rifle"
description = "Advanced alien energy weapon firing superheated plasma bolts."

# Weapon classification
category = "primary"          # primary, secondary, heavy, melee
type = "rifle"               # pistol, rifle, shotgun, sniper, heavy, melee
tier = 3                     # 1=early, 2=mid, 3=late game

# Core combat stats
[weapon.stats]
damage_min = 50              # Minimum damage roll
damage_max = 75              # Maximum damage roll
accuracy = 85                # Base hit chance %
critical_chance = 15         # % chance for critical hit
critical_multiplier = 2.0    # Critical damage multiplier
range_optimal = 12           # Tiles for optimal accuracy
range_maximum = 20           # Maximum effective range

# Action point costs
[weapon.action_costs]
fire = 3                     # AP to fire once
reload = 2                   # AP to reload
equip = 1                    # AP to switch to this weapon
melee = 2                    # AP for melee attack with weapon

# Ammunition system
[weapon.ammo]
magazine_size = 24           # Rounds per magazine
ammo_type = "plasma_cell"    # Ammunition item ID
infinite_ammo = false        # Does this weapon need reloading?
reload_sound = "sfx/reload_plasma.ogg"

# Special properties
[weapon.properties]
armor_piercing = 15          # Ignores 15 points of armor
penetration = true           # Can shoot through light cover
two_handed = true            # Requires both hands
silenced = false             # Does not alert distant enemies
explosive = false            # Does not cause area damage

# Range penalties (accuracy drops with distance)
[weapon.range_penalties]
# Per tile beyond optimal range
accuracy_penalty_per_tile = 3
# Example: At range 15 (3 beyond optimal), accuracy = 85 - (3*3) = 76%

# Damage falloff (optional damage reduction at range)
[weapon.damage_falloff]
enabled = false              # Plasma doesn't fall off
falloff_start = 0
damage_reduction_per_tile = 0

# Environmental effects
[weapon.environmental]
affected_by_weather = false  # Energy weapons ignore weather
affected_by_smoke = true     # Smoke reduces accuracy by -20%
affected_by_darkness = false # Built-in targeting systems
friendly_fire = true         # Can damage allies
destroys_cover = true        # Damages environmental objects

# Status effects (applied on hit)
[[weapon.status_effects]]
effect = "burning"
chance = 0.25                # 25% chance to ignite target
duration = 2                 # Lasts 2 turns
damage_per_turn = 3

# Manufacturing requirements
[weapon.manufacturing]
craftable = true
research_required = "plasma_weapons"
cost_credits = 8000
cost_materials = [
    { item = "alien_alloys", quantity = 10 },
    { item = "elerium", quantity = 5 },
    { item = "plasma_accelerator", quantity = 1 }
]
manufacturing_hours = 40     # Engineer-hours required
workshop_tier = 2            # Requires advanced workshop

# Purchase availability
[weapon.market]
available_in_stores = false  # Cannot buy, must craft
black_market_available = true
black_market_price = 25000   # Much more expensive
sell_price = 12000           # Player can sell for this
stock_refresh_weight = 2     # Rarity in black market (lower = rarer)

# Equipment restrictions
[weapon.requirements]
min_strength = 0             # No strength requirement
min_rank = "corporal"        # Must be Corporal or higher
classes_allowed = []         # Empty = all classes can use
classes_forbidden = []       # No forbidden classes

# Visual and audio
[weapon.presentation]
sprite = "assets/weapons/plasma_rifle.png"  # 10×10 sprite scaled ×2
icon = "assets/icons/plasma_rifle.png"      # 20×20 icon
fire_animation = "plasma_bolt"
muzzle_flash = "plasma_flash"
impact_effect = "plasma_impact"
sound_fire = "sfx/plasma_fire.ogg"
sound_impact = "sfx/plasma_impact.ogg"
tracer_color = { r = 100, g = 255, b = 100 }  # Green plasma

# Tactical behavior (AI usage)
[weapon.ai_behavior]
preferred_range = 8          # AI prefers this range
aggression_bonus = 0.2       # Powerful weapon increases aggression
target_priority = [
    { target_type = "armored", priority = 0.9 },    # Good vs armor
    { target_type = "unarmored", priority = 0.8 },
    { target_type = "mechanical", priority = 0.7 }
]

# Upgrade slots
[[weapon.upgrades]]
slot = "scope"
compatible_upgrades = ["plasma_targeting_scope", "alien_targeting_computer"]
effect_description = "Improves accuracy"

[[weapon.upgrades]]
slot = "magazine"
compatible_upgrades = ["extended_plasma_cell", "overcharged_cell"]
effect_description = "Increases capacity or damage"

[[weapon.upgrades]]
slot = "barrel"
compatible_upgrades = ["plasma_stabilizer", "cooling_fins"]
effect_description = "Reduces recoil or heat buildup"

# Alternate fire modes (optional)
[[weapon.fire_modes]]
id = "standard"
name = "Standard Shot"
ap_cost = 3
damage_multiplier = 1.0
accuracy_modifier = 0
description = "Normal plasma shot"

[[weapon.fire_modes]]
id = "overcharge"
name = "Overcharged Shot"
ap_cost = 5
damage_multiplier = 1.5
accuracy_modifier = -10
ammo_cost = 3                # Uses 3 rounds instead of 1
cooldown = 2                 # Can't use again for 2 turns
description = "Powerful shot with reduced accuracy and high ammo cost"

[[weapon.fire_modes]]
id = "suppression"
name = "Suppressive Fire"
ap_cost = 4
damage_multiplier = 0.7
accuracy_modifier = -15
effect = "suppression"       # Applies suppression status to target
description = "Reduces enemy accuracy but deals less damage"

# Balance metadata
[weapon.balance]
power_level = 90             # 0-100 relative power
expected_unlock_month = 5    # Month 5+
player_power_jump = 20       # 20% increase in combat effectiveness
cost_effectiveness = 0.7     # Damage per credit spent (relative)

# Comparison with other weapons (for balance reference)
[weapon.balance.comparisons]
tier2_rifle_damage = 1.5     # 50% more damage than tier 2 rifle
tier2_rifle_accuracy = 1.06  # 6% more accurate
tier2_rifle_cost = 2.0       # 2× the cost

# Deterministic RNG scopes
[weapon.rng_scopes]
damage = "weapon:plasma_rifle:damage"
critical = "weapon:plasma_rifle:critical"
status_effect = "weapon:plasma_rifle:status"

# Modding support
[weapon.modding]
mod_id = "base_game"
author = "AlienFall Team"
version = "1.0.0"
override_priority = 100
tags = ["plasma", "energy", "alien_tech", "late_game", "high_damage"]

# Balance notes for modders
[weapon.modding.balance_notes]
note = """
The Plasma Rifle is designed as the tier 3 standard weapon, representing
a significant power spike when the player completes alien weapons research.

Key balance considerations:
- High damage (50-75) makes it effective against armored targets
- Good accuracy (85%) ensures reliable hits
- 15 armor piercing overcomes most enemy armor
- High manufacturing cost (8000 + materials) gates access to late game
- Requires corporal rank to prevent early-game power creep if unlocked early

If modding, consider:
- Reducing damage if lowering manufacturing cost
- Increasing AP cost if adding special fire modes
- Adding ammo scarcity if making damage too high
"""
